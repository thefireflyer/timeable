(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8581:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3678)}])},3678:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var o=n(5893),i=n(9008),s=n(7294),r=n(6440),a=n.n(r);function c(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var d=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function m(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=l(e);if(t){var i=l(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return u(this,n)}}var h="timeable.data";function p(){return(0,o.jsx)("div",{style:{marginBottom:"16vh"}})}var g,v=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(l,e);var t,n,s,r=m(l);function l(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),t=r.call(this,e);var n=new Date;return t.currentDate=n.toDateString(),t.state={days:{},notifications:!1,version:1},t.state.days[n.toDateString()]||(t.state.days[t.currentDate]=t.createDayTemplate()),t}return t=l,(n=[{key:"createDayTemplate",value:function(){for(var e=[],t=0;t<=24;t++)e.push({title:"",desc:"",activity:null,hour:t});return e}},{key:"updateLoop",value:function(){console.log(this.state);var e=new Date;document.getElementById(a().offlineIcon).style.display=navigator.onLine?"none":"block",this.forceUpdate();var t,n=this.state.days[this.currentDate][e.getHours()];if(console.log(e.getHours()),console.log(n),""!=n.title&&this.state.notifications)if(e.getMinutes()<1&&e.getSeconds()<30){console.log("displaying notifications");var o=n.title+" now starting.\n  "+n.desc;t=o,"granted"==Notification.permission&&navigator.serviceWorker.getRegistration().then((function(e){var n={body:t,icon:"icon.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1},actions:[{action:"snooze",title:"snooze",icon:"icon.png"},{action:"markAsComplete",title:"mark as complete",icon:"icon.png"}]};e.showNotification("timeable",n)}))}else console.log(e.getMinutes()),console.log(e.getSeconds())}},{key:"componentDidMount",value:function(){var e=this,t=(window.setInterval((function(){e.updateLoop()}),3e4),localStorage.getItem(h));null==t&&this.saveData();try{var n=JSON.parse(t);if(!n.version)throw ErrorEvent;if(n.version<1)throw ErrorEvent;this.setState(n)}catch(o){console.log(o),this.saveData()}this.forceUpdate(),Notification.requestPermission().then((function(e){console.log(e)})),document.body.addEventListener("mouseup",y),this.updateLoop(),this.forceUpdate()}},{key:"updateData",value:function(){if(this.state.currentSegment){var e=document.getElementById(a().timeSegmentOptions);this.state.currentSegment().title=e.querySelector("#title").value,this.state.currentSegment().desc=e.querySelector("#description").value,this.forceUpdate()}}},{key:"saveData",value:function(){this.state.currentSegment=null,this.state.mouseTimer=null,this.state.eventInfo=null,localStorage.setItem(h,JSON.stringify(this.state)),console.log(this.state)}},{key:"closeAll",value:function(){this.updateData(),document.getElementById(a().container).style.left="0",document.getElementById(a().closeSettings).style.display="none",document.getElementById(a().timeSegmentOptions).style.top="100vh",this.saveData()}},{key:"mouseDown",value:function(e,t){this.state.eventInfo=e,this.state.mouseTimer=window.setTimeout((function(){return t()}),500)}},{key:"mouseUp",value:function(){this.state.mouseTimer&&window.clearTimeout(this.state.mouseTimer),this.state.eventInfo=null}},{key:"execMouseDown",value:function(){var e,t=this,n=(null===(e=this.state.eventInfo.touches)||void 0===e?void 0:e.item("0").target)||this.state.eventInfo.target;console.log(n),console.log(n.attributes.segment.value),this.state.currentSegment=function(){return t.state.days[t.currentDate][n.attributes.segment.value]};var o=document.getElementById(a().timeSegmentOptions);o.querySelector("#title").value=this.state.currentSegment().title,o.querySelector("#description").value=this.state.currentSegment().desc,document.getElementById(a().timeSegmentOptions).style.top="30vh",document.getElementById(a().closeSettings).style.display="block"}},{key:"clearTimeSegmentData",value:function(){this.state.days[this.currentDate].forEach((function(e){e.title="",e.desc=""})),this.saveData(),this.forceUpdate()}},{key:"clearAllAppData",value:function(){localStorage.setItem(h,null),location.reload()}},{key:"render",value:function(){var e=this;return this.state.days[this.currentDate]||(this.state.days[this.currentDate]=this.createDayTemplate()),(0,o.jsxs)("div",{id:a().container,children:[(0,o.jsxs)(i.default,{children:[(0,o.jsx)("title",{children:"Timeable"}),(0,o.jsx)("meta",{name:"description",content:"Free open source time management app"}),(0,o.jsx)("link",{rel:"icon",href:"icon.png"}),(0,o.jsx)("link",{href:"https://fonts.googleapis.com/icon?family=Material+Icons+Outlined",rel:"stylesheet"}),(0,o.jsx)("link",{rel:"manifest",href:"/timeable/manifest.json"}),(0,o.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"true"}),(0,o.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Open+Sans:wght@300&display=swap",rel:"stylesheet"})]}),(0,o.jsxs)("main",{id:a().main,children:[(0,o.jsxs)("div",{className:a().app,children:[(0,o.jsx)("div",{className:a().activities}),(0,o.jsxs)("div",{className:a().timesheet,children:[this.state.days[this.currentDate].map((function(t){var n,i=e;return(0,o.jsxs)("div",{className:a().timeSegment,onTouchStart:function(e){return i.mouseDown(e,(function(){return i.execMouseDown()}))},onMouseDown:function(e){return i.mouseDown(e,(function(){return i.execMouseDown()}))},onTouchEnd:function(){return i.mouseUp()},onTouchCancel:function(){return i.mouseUp()},onMouseUp:function(){return i.mouseUp()},onTouchMove:function(e){},style:{borderColor:(null===(n=t.activity)||void 0===n?void 0:n.color)||"#333"},segment:t.hour,children:[(0,o.jsx)("h3",{children:t.hour+":00"}),(0,o.jsx)("h2",{children:t.title}),(0,o.jsx)("h4",{children:t.desc})]},t.hour)})),(0,o.jsx)(p,{})]}),(0,o.jsx)("div",{className:a().menubar})]}),(0,o.jsx)("div",{className:a().dateHeader,children:(0,o.jsxs)("h3",{children:[(0,o.jsx)("b",{onClick:function(){var t=new Date(e.currentDate);t.setDate(t.getDate()-1),e.currentDate=t.toDateString(),e.forceUpdate()},children:" < "}),this.currentDate,(0,o.jsx)("b",{onClick:function(){var t=new Date(e.currentDate);t.setDate(t.getDate()+1),e.currentDate=t.toDateString(),e.forceUpdate()},children:" > "})]})}),(0,o.jsx)("div",{className:a().dropOff}),(0,o.jsx)("a",{onClick:function(){screen.width>600?document.getElementById(a().container).style.left="-20vw":document.getElementById(a().container).style.left="-85vw",document.getElementById(a().closeSettings).style.display="block"},id:a().openSettings,children:(0,o.jsx)("span",{className:"material-icons-outlined "+a().pin,children:"settings"})}),(0,o.jsx)("a",{onClick:function(){return e.closeAll()},id:a().closeSettings}),(0,o.jsxs)("div",{id:a().bottomPins,children:[(0,o.jsx)("span",{id:a().offlineIcon,className:"material-icons-outlined "+a().pin,children:"offline_pin"}),(0,o.jsx)("span",{className:"material-icons-outlined "+a().pin,onClick:function(){window.location.href="https://github.com/theflyingfire/timeable"},children:"code"})]}),(0,o.jsxs)("div",{id:a().timeSegmentOptions,children:[(0,o.jsx)("input",{type:"text",placeholder:"title",id:"title"}),(0,o.jsx)("input",{type:"text",placeholder:"description",id:"description"}),(0,o.jsx)(p,{})]})]}),(0,o.jsx)("div",{id:a().settings,children:(0,o.jsxs)("center",{id:a().settingsPanel,children:[(0,o.jsx)("h1",{children:"Settings"}),(0,o.jsx)("h3",{onClick:function(){e.state.notifications=!e.state.notifications,e.forceUpdate()},children:this.state.notifications?"Disable notifications":"Enable notifications"}),(0,o.jsx)("h3",{onTouchStart:function(t){return e.mouseDown(t,(function(){return e.clearTimeSegmentData()}))},onMouseDown:function(t){return e.mouseDown(t,(function(){return e.clearTimeSegmentData()}))},onTouchEnd:function(){return e.mouseUp()},onTouchCancel:function(){return e.mouseUp()},onMouseUp:function(){return e.mouseUp()},children:"Clear today"}),(0,o.jsx)("h3",{onTouchStart:function(t){return e.mouseDown(t,(function(){return e.clearAllAppData()}))},onMouseDown:function(t){return e.mouseDown(t,(function(){return e.clearAllAppData()}))},onTouchEnd:function(){return e.mouseUp()},onTouchCancel:function(){return e.mouseUp()},onMouseUp:function(){return e.mouseUp()},style:{backgroundColor:"red",color:"black"},children:"Clear ALL data"}),(0,o.jsx)(p,{})]})})]})}}])&&c(t.prototype,n),s&&c(t,s),l}(s.Component);function y(){g&&window.clearTimeout(g),null}},6440:function(e){e.exports={container:"Home_container__97eC3",main:"Home_main__OVLM4",grid:"Home_grid__npx0i",openSettings:"Home_openSettings__5bp_w",settings:"Home_settings__G0Zfp",settingsPanel:"Home_settingsPanel__dZUoF",closeSettings:"Home_closeSettings__ESeew",bottomPins:"Home_bottomPins__aewl9",pin:"Home_pin__lleej",offlineIcon:"Home_offlineIcon__3EauL",app:"Home_app__GbKKX",section:"Home_section__EaDnq",timesheet:"Home_timesheet__NkTkH",timeSegment:"Home_timeSegment__t6lh_",timeSegmentOptions:"Home_timeSegmentOptions__8WA_M",dropOff:"Home_dropOff__iGdGr",dateHeader:"Home_dateHeader__VwGPK"}},9008:function(e,t,n){e.exports=n(5443)}},function(e){e.O(0,[774,888,179],(function(){return t=8581,e(e.s=t);var t}));var t=e.O();_N_E=t}]);