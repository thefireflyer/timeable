(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[623],{8856:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/index_old",function(){return n(7245)}])},7245:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var o=n(5893),i=(n(9008),n(7294)),r=n(6440),s=n.n(r);function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){l(e,t,n[t])}))}return e}function f(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){return e&&"undefined"!==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(o,arguments,i)}else n=o.apply(this,arguments);return f(this,n)}}var y="timeable.data";function _(){return(0,o.jsx)("div",{style:{marginBottom:"16vh"}})}function S(e){e.time;var t=e.onSelectStart,n=e.onSelectDrag,i=e.onSelectEnd,r=e.onTouchSelect;e.selected;return(0,o.jsx)("div",{className:s().selector,onMouseDown:t,onMouseMove:n,onMouseUp:i,onTouchStart:r,onTouchCancel:i,onTouchEnd:i})}var D,w=function(e){var t=function(t){p.push((0,o.jsx)(S,{time:t,onSelectStart:function(){return d({start:t,end:t,selecting:!0})},onSelectDrag:function(e){e.preventDefault(),l.selecting&&(d(h({},l,{end:t})),console.log(l))},onSelectEnd:function(){d(h({},l,{selecting:!1}))},onTouchSelect:function(){d({start:t,end:t+1,selecting:!1}),e.schedule.forEach((function(e){null!=e&&(console.log(e),(e.hour<=t&&t<=e.hour+e.length||e.hour<=t+1&&t+1<=e.hour+e.length)&&(console.log("!!!!!"),d({start:null,end:null,selecting:!1})))}))},selected:null!==l.start&&(l.start<=t&&t<=l.end||l.start>=t&&t>=l.end)}))},n=function(){a=window.setTimeout((function(){return u()}),500)},r=function(){window.clearTimeout(a),a=null},u=function(){if(window.clearTimeout(a),a=null,Math.abs(l.end-l.start)<1)console.log("???");else{var t={hour:l.start<l.end?l.start:l.end,length:Math.abs(l.end-l.start),title:"",desc:""};d({start:null,end:null,selecting:!1}),e.onTimeSegmentSelected(t);var n=document.getElementById(s().timeSegmentOptions);n.querySelector("#title").value="",n.querySelector("#description").value="",document.getElementById(s().timeSegmentOptions).style.top="30vh",document.getElementById(s().closeSettings).style.display="block"}};console.log(e.schedule);for(var a=null,c=(0,i.useState)({start:null,end:null,selecting:!1}),l=c[0],d=c[1],m=[],f=0;f<24;f++)m.push((0,o.jsx)("div",{className:s().label,onClick:function(){d({start:null,end:null,selecting:!1})},children:(0,o.jsx)("h3",{children:f+":00"})},f));for(var p=[],g=0;g<48;g++)t(g);var v=null;return null!=l.start&&null!=l.end&&(v=(0,o.jsxs)("div",{className:s().timeSegment,style:{borderColor:"#333",position:"absolute",top:"".concat(5*(l.start<l.end?l.start:l.end)+5,"vh"),height:"".concat(5*Math.abs(l.end-l.start)+5,"vh")},segment:l.start,onContextMenu:function(e){e.preventDefault(),d({start:null,end:null,selecting:!1})},onTouchStart:function(e){return n()},onMouseDown:function(e){return n()},onTouchEnd:function(){return r()},onTouchCancel:function(){return r()},onMouseUp:function(){return r()},onDoubleClick:u,children:[(0,o.jsx)("h2",{children:""}),(0,o.jsx)("h4",{children:""})]},"selection")),(0,o.jsxs)("div",{className:s().timesheet,children:[(0,o.jsx)("div",{className:s().selectors,children:p}),e.schedule.map((function(t){return(0,o.jsx)(x,{onTimeSegmentSelected:e.onTimeSegmentSelected,data:t})})),(0,o.jsx)("div",{className:s().labels,children:m}),v,(0,o.jsx)(_,{})]})},x=function(e){m(n,e);var t=v(n);function n(e){var o;return u(this,n),(o=t.call(this,e)).state={},o}return c(n,[{key:"mouseDown",value:function(e,t){this.state.eventInfo=e,this.state.mouseTimer=window.setTimeout((function(){return t()}),500)}},{key:"mouseUp",value:function(){this.state.mouseTimer&&window.clearTimeout(this.state.mouseTimer),this.state.eventInfo=null}},{key:"execMouseDown",value:function(){this.props.onTimeSegmentSelected(this.props.data);var e=document.getElementById(s().timeSegmentOptions);e.querySelector("#title").value=this.props.data.title,e.querySelector("#description").value=this.props.data.desc,document.getElementById(s().timeSegmentOptions).style.top="30vh",document.getElementById(s().closeSettings).style.display="block"}},{key:"render",value:function(){var e=this;if(null==this.props.data)return(0,o.jsx)(o.Fragment,{});var t=2*(new Date).getHours();return(0,o.jsxs)("div",{className:s().timeSegment,style:{borderColor:this.props.data.hour<=t&&t<=this.props.data.hour+this.props.data.length?"red":"#333",position:"absolute",top:"".concat(5*(this.props.data.hour+1),"vh"),height:"".concat(5*(this.props.data.length+1),"vh")},segment:this.props.data.hour,children:[(0,o.jsx)("div",{id:s().timeSegmentBg,onTouchStart:function(t){return e.mouseDown(t,(function(){return e.execMouseDown()}))},onMouseDown:function(t){return e.mouseDown(t,(function(){return e.execMouseDown()}))},onTouchEnd:function(){return e.mouseUp()},onTouchCancel:function(){return e.mouseUp()},onMouseUp:function(){return e.mouseUp()},onDoubleClick:function(){return e.execMouseDown()},onContextMenu:function(e){e.preventDefault()},onTouchMove:function(e){}}),(0,o.jsx)("h2",{children:this.props.data.title}),(0,o.jsx)("h4",{children:this.props.data.desc}),(0,o.jsxs)("div",{className:s().timeSegmentTop,children:[(0,o.jsx)("div",{}),(0,o.jsx)("div",{})]}),(0,o.jsxs)("div",{className:s().timeSegmentBottom,children:[(0,o.jsx)("div",{}),(0,o.jsx)("div",{})]})]},this.props.data.hour)}}]),n}(i.Component),j=function(e){m(n,e);var t=v(n);function n(e){var o;u(this,n),o=t.call(this,e);var i=new Date;return o.currentDate=i.toDateString(),o.currentWeek=[],o.selectedSegments=[],o.state={days:{},notifications:!1,version:2},o.state.days[i.toDateString()]||(o.state.days[o.currentDate]=o.createDayTemplate()),o}return c(n,[{key:"createDayTemplate",value:function(){return[]}},{key:"updateLoop",value:function(){}},{key:"componentDidMount",value:function(){var e=this,t=(window.setInterval((function(){e.updateLoop()}),3e4),localStorage.getItem(y));null==t&&this.saveData();try{var n=JSON.parse(t);if(!n.version)throw ErrorEvent;if(n.version<2)throw ErrorEvent;this.setState(n)}catch(o){console.log(o),this.saveData()}this.forceUpdate(),Notification.requestPermission().then((function(e){console.log(e)})),document.body.addEventListener("mouseup",b),this.updateLoop(),this.forceUpdate()}},{key:"updateData",value:function(){if(this.state.currentSegment){var e=document.getElementById(s().timeSegmentOptions);this.state.currentSegment().title=e.querySelector("#title").value,this.state.currentSegment().desc=e.querySelector("#description").value,this.forceUpdate()}}},{key:"saveData",value:function(){this.state.currentSegment=null,this.state.mouseTimer=null,this.state.eventInfo=null,localStorage.setItem(y,JSON.stringify(this.state)),console.log(this.state)}},{key:"closeAll",value:function(){this.updateData(),document.getElementById(s().container).style.left="0",document.getElementById(s().closeSettings).style.display="none",document.getElementById(s().timeSegmentOptions).style.top="100vh",this.saveData()}},{key:"mouseDown",value:function(e,t){this.state.eventInfo=e,this.state.mouseTimer=window.setTimeout((function(){return t()}),500)}},{key:"mouseUp",value:function(){this.state.mouseTimer&&window.clearTimeout(this.state.mouseTimer),this.state.eventInfo=null}},{key:"execMouseDown",value:function(){}},{key:"clearCurrentDate",value:function(){this.state.days[this.currentDate]=[],this.saveData(),this.forceUpdate()}},{key:"clearAllAppData",value:function(){localStorage.setItem(y,null),location.reload()}},{key:"deleteTimeSegment",value:function(){var e=this;this.state.days[this.currentDate]=this.state.days[this.currentDate].filter((function(t){return t!==e.state.currentSegment()})),this.state.currentSegment=null,this.closeAll(),this.forceUpdate()}},{key:"render",value:function(){var e,t,n,i,r=this;return this.state.days[this.currentDate]||(this.state.days[this.currentDate]=this.createDayTemplate()),(0,o.jsxs)("div",{id:s().container,children:[(0,o.jsxs)("main",{id:s().main,children:[(0,o.jsxs)("div",{className:s().app,children:[(0,o.jsx)("div",{className:s().activities}),(0,o.jsx)(w,{onTimeSegmentSelected:function(e){var t=r;null!=e&&(console.log(e),r.state.days[r.currentDate][e.hour]=e,console.log(r.state.days[r.currentDate]),r.state.currentSegment=function(){return t.state.days[t.currentDate][e.hour]},r.forceUpdate())},schedule:this.state.days[this.currentDate]},this.state.days[this.currentDate]),(0,o.jsx)("div",{className:s().menubar})]}),(0,o.jsx)("div",{className:s().dateHeader,children:(0,o.jsxs)("h3",{children:[(0,o.jsx)("b",{onClick:function(){var e=new Date(r.currentDate);e.setDate(e.getDate()-1),r.currentDate=e.toDateString(),r.forceUpdate()},children:" < "}),this.currentDate==(new Date).toDateString()?this.currentDate+" (Today)":this.currentDate,(0,o.jsx)("b",{onClick:function(){var e=new Date(r.currentDate);e.setDate(e.getDate()+1),r.currentDate=e.toDateString(),r.forceUpdate()},children:" > "})]})}),(0,o.jsx)("div",{className:s().dropOff}),(0,o.jsx)("a",{onClick:function(){screen.width>600?document.getElementById(s().container).style.left="-20vw":document.getElementById(s().container).style.left="-85vw",document.getElementById(s().closeSettings).style.display="block"},id:s().openSettings,children:(0,o.jsx)("span",{className:"material-icons-outlined "+s().pin,children:"settings"})}),(0,o.jsx)("a",{onClick:function(){return r.closeAll()},id:s().closeSettings}),(0,o.jsxs)("div",{id:s().bottomPins,children:[(0,o.jsx)("span",{id:s().offlineIcon,className:"material-icons-outlined "+s().pin,children:"offline_pin"}),(0,o.jsx)("span",{className:"material-icons-outlined "+s().pin,onClick:function(){window.location.href="https://github.com/theflyingfire/timeable"},children:"code"})]}),(0,o.jsxs)("div",{id:s().timeSegmentOptions,children:[(0,o.jsx)("input",{type:"text",placeholder:"title",id:"title"}),(0,o.jsx)("input",{type:"text",placeholder:"description",id:"description"}),(0,o.jsxs)("h1",{children:[null===(e=this.state.currentSegment)||void 0===e?void 0:e.hour," time"]}),(0,o.jsx)("input",{type:"time",defaultValue:(null===(t=this.state.currentSegment)||void 0===t?void 0:t.hour)+":00",className:s().timeSelectors}),(0,o.jsx)("input",{type:"time",defaultValue:(null===(n=this.state.currentSegment)||void 0===n?void 0:n.hour)+(null===(i=this.state.currentSegment)||void 0===i?void 0:i.length)+":00",className:s().timeSelectors}),(0,o.jsx)("h3",{id:s().deleteTimeSegmentButton,onTouchStart:function(e){return r.mouseDown(e,(function(){return r.deleteTimeSegment()}))},onMouseDown:function(e){return r.mouseDown(e,(function(){return r.deleteTimeSegment()}))},onTouchEnd:function(){return r.mouseUp()},onTouchCancel:function(){return r.mouseUp()},onMouseUp:function(){return r.mouseUp()},children:"delete"}),(0,o.jsx)(_,{})]})]}),(0,o.jsx)("div",{id:s().settings,children:(0,o.jsxs)("center",{id:s().settingsPanel,children:[(0,o.jsx)("h1",{children:"Settings"}),(0,o.jsx)("h3",{onClick:function(){r.state.notifications=!r.state.notifications,r.forceUpdate()},children:this.state.notifications?"Disable notifications":"Enable notifications"}),(0,o.jsx)("h3",{onTouchStart:function(e){return r.mouseDown(e,(function(){return r.clearCurrentDate()}))},onMouseDown:function(e){return r.mouseDown(e,(function(){return r.clearCurrentDate()}))},onTouchEnd:function(){return r.mouseUp()},onTouchCancel:function(){return r.mouseUp()},onMouseUp:function(){return r.mouseUp()},children:"Clear today"}),(0,o.jsx)("h3",{onTouchStart:function(e){return r.mouseDown(e,(function(){return r.clearAllAppData()}))},onMouseDown:function(e){return r.mouseDown(e,(function(){return r.clearAllAppData()}))},onTouchEnd:function(){return r.mouseUp()},onTouchCancel:function(){return r.mouseUp()},onMouseUp:function(){return r.mouseUp()},style:{backgroundColor:"red",color:"black"},children:"Clear ALL data"}),(0,o.jsx)(_,{})]})})]})}}]),n}(i.Component);function b(){D&&window.clearTimeout(D),null}},6440:function(e){e.exports={container:"Home_container__97eC3",main:"Home_main__OVLM4",grid:"Home_grid__npx0i",openSettings:"Home_openSettings__5bp_w",settings:"Home_settings__G0Zfp",settingsPanel:"Home_settingsPanel__dZUoF",closeSettings:"Home_closeSettings__ESeew",bottomPins:"Home_bottomPins__aewl9",pin:"Home_pin__lleej",offlineIcon:"Home_offlineIcon__3EauL",app:"Home_app__GbKKX",section:"Home_section__EaDnq",timesheet:"Home_timesheet__NkTkH",timeSegment:"Home_timeSegment__t6lh_",timeSegmentBg:"Home_timeSegmentBg__UUWAh",timeSegmentOptions:"Home_timeSegmentOptions__8WA_M",timeSelectors:"Home_timeSelectors__OklHP",deleteTimeSegmentButton:"Home_deleteTimeSegmentButton__6O4mW",dropOff:"Home_dropOff__iGdGr",dateHeader:"Home_dateHeader__VwGPK",timeSegmentEdge:"Home_timeSegmentEdge__O__Ip",timeSegmentBottom:"Home_timeSegmentBottom__1ZGTy",timeSegmentTop:"Home_timeSegmentTop__ROM_4",labels:"Home_labels__Vi7F_",label:"Home_label__5_9DN",selectors:"Home_selectors__yw6IZ",selector:"Home_selector__a6WuC"}}},function(e){e.O(0,[774,888,179],(function(){return t=8856,e(e.s=t);var t}));var t=e.O();_N_E=t}]);